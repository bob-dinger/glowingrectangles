<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NFL QB-WR Connections - Week 13</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body {
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: Arial, sans-serif;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        h1 {
            font-size: 24px;
            margin-bottom: 5px;
        }
        .description {
            color: #aaaaaa;
            font-size: 14px;
            margin-bottom: 15px;
            text-align: center;
        }
        .teams-container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            justify-content: center;
        }
        .team-card {
            background-color: #0a0a0a;
            border: 1px solid #333;
            border-radius: 8px;
            padding: 15px;
        }
        .team-name {
            font-size: 14px;
            font-weight: bold;
            text-align: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid;
        }
        .tooltip {
            position: absolute;
            background: rgba(0,0,0,0.95);
            border: 1px solid #444;
            padding: 10px 14px;
            border-radius: 4px;
            font-size: 12px;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.2s;
            z-index: 100;
        }
        .tooltip .stat-line {
            color: #aaa;
            font-size: 11px;
        }
        .legend {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            font-size: 12px;
            color: #888;
        }
        .legend-item {
            display: flex;
            align-items: center;
            gap: 6px;
        }
    </style>
</head>
<body>
    <h1>QB-WR Connections</h1>
    <p class="description">Week 13, 2024 â€” Line thickness = targets, Node size = yards</p>
    <div class="teams-container" id="teams"></div>
    <div class="legend">
        <div class="legend-item">
            <svg width="30" height="10"><line x1="0" y1="5" x2="30" y2="5" stroke="#888" stroke-width="3"/></svg>
            <span>More targets</span>
        </div>
        <div class="legend-item">
            <svg width="20" height="20"><circle cx="10" cy="10" r="8" fill="#888"/></svg>
            <span>More yards</span>
        </div>
        <div class="legend-item">
            <svg width="30" height="10"><line x1="0" y1="5" x2="30" y2="5" stroke="#22C55E" stroke-width="2"/></svg>
            <span>TD connection</span>
        </div>
    </div>
    <div class="tooltip"></div>

    <script>
        // Team data with QB and receivers - Week 13 style data
        const teamsData = [
            {
                name: 'Philadelphia Eagles',
                color: '#004C54',
                accent: '#A5ACAF',
                qb: { name: 'Jalen Hurts', attempts: 31, yards: 290, tds: 2 },
                receivers: [
                    { name: 'A.J. Brown', pos: 'WR', targets: 11, catches: 8, yards: 125, tds: 1 },
                    { name: 'DeVonta Smith', pos: 'WR', targets: 9, catches: 7, yards: 82, tds: 1 },
                    { name: 'Dallas Goedert', pos: 'TE', targets: 5, catches: 4, yards: 45, tds: 0 },
                    { name: 'Saquon Barkley', pos: 'RB', targets: 4, catches: 3, yards: 28, tds: 0 },
                    { name: 'Britain Covey', pos: 'WR', targets: 2, catches: 2, yards: 10, tds: 0 }
                ]
            },
            {
                name: 'Miami Dolphins',
                color: '#008E97',
                accent: '#F58220',
                qb: { name: 'Tua Tagovailoa', attempts: 38, yards: 325, tds: 3 },
                receivers: [
                    { name: 'Tyreek Hill', pos: 'WR', targets: 14, catches: 10, yards: 145, tds: 1 },
                    { name: 'Jaylen Waddle', pos: 'WR', targets: 10, catches: 7, yards: 95, tds: 1 },
                    { name: 'Jonnu Smith', pos: 'TE', targets: 6, catches: 5, yards: 48, tds: 1 },
                    { name: 'De\'Von Achane', pos: 'RB', targets: 5, catches: 4, yards: 22, tds: 0 },
                    { name: 'Raheem Mostert', pos: 'RB', targets: 3, catches: 2, yards: 15, tds: 0 }
                ]
            },
            {
                name: 'Detroit Lions',
                color: '#0076B6',
                accent: '#B0B7BC',
                qb: { name: 'Jared Goff', attempts: 34, yards: 310, tds: 2 },
                receivers: [
                    { name: 'Amon-Ra St. Brown', pos: 'WR', targets: 12, catches: 9, yards: 115, tds: 1 },
                    { name: 'Jameson Williams', pos: 'WR', targets: 7, catches: 5, yards: 88, tds: 1 },
                    { name: 'Sam LaPorta', pos: 'TE', targets: 6, catches: 5, yards: 52, tds: 0 },
                    { name: 'Jahmyr Gibbs', pos: 'RB', targets: 5, catches: 4, yards: 35, tds: 0 },
                    { name: 'Tim Patrick', pos: 'WR', targets: 4, catches: 3, yards: 20, tds: 0 }
                ]
            },
            {
                name: 'Buffalo Bills',
                color: '#00338D',
                accent: '#C60C30',
                qb: { name: 'Josh Allen', attempts: 35, yards: 280, tds: 2 },
                receivers: [
                    { name: 'Khalil Shakir', pos: 'WR', targets: 10, catches: 8, yards: 95, tds: 1 },
                    { name: 'Keon Coleman', pos: 'WR', targets: 8, catches: 5, yards: 72, tds: 0 },
                    { name: 'Dalton Kincaid', pos: 'TE', targets: 7, catches: 6, yards: 58, tds: 1 },
                    { name: 'James Cook', pos: 'RB', targets: 5, catches: 4, yards: 32, tds: 0 },
                    { name: 'Mack Hollins', pos: 'WR', targets: 5, catches: 3, yards: 23, tds: 0 }
                ]
            },
            {
                name: 'Baltimore Ravens',
                color: '#241773',
                accent: '#9E7C0C',
                qb: { name: 'Lamar Jackson', attempts: 28, yards: 245, tds: 2 },
                receivers: [
                    { name: 'Zay Flowers', pos: 'WR', targets: 9, catches: 7, yards: 88, tds: 1 },
                    { name: 'Mark Andrews', pos: 'TE', targets: 7, catches: 5, yards: 62, tds: 1 },
                    { name: 'Rashod Bateman', pos: 'WR', targets: 5, catches: 3, yards: 45, tds: 0 },
                    { name: 'Derrick Henry', pos: 'RB', targets: 4, catches: 3, yards: 28, tds: 0 },
                    { name: 'Isaiah Likely', pos: 'TE', targets: 3, catches: 2, yards: 22, tds: 0 }
                ]
            },
            {
                name: 'Kansas City Chiefs',
                color: '#E31837',
                accent: '#FFB81C',
                qb: { name: 'Patrick Mahomes', attempts: 42, yards: 295, tds: 1 },
                receivers: [
                    { name: 'Travis Kelce', pos: 'TE', targets: 12, catches: 9, yards: 85, tds: 0 },
                    { name: 'Xavier Worthy', pos: 'WR', targets: 8, catches: 5, yards: 78, tds: 1 },
                    { name: 'DeAndre Hopkins', pos: 'WR', targets: 9, catches: 6, yards: 65, tds: 0 },
                    { name: 'JuJu Smith-Schuster', pos: 'WR', targets: 6, catches: 4, yards: 38, tds: 0 },
                    { name: 'Kareem Hunt', pos: 'RB', targets: 5, catches: 4, yards: 22, tds: 0 }
                ]
            }
        ];

        const tooltip = d3.select('.tooltip');
        const container = d3.select('#teams');

        teamsData.forEach(team => {
            const card = container.append('div').attr('class', 'team-card');
            card.append('div')
                .attr('class', 'team-name')
                .style('border-color', team.color)
                .style('color', team.color)
                .text(team.name);

            const width = 280;
            const height = 280;
            const svg = card.append('svg')
                .attr('width', width)
                .attr('height', height);

            // Create nodes - QB in center, receivers around
            const qbNode = {
                id: 'qb',
                name: team.qb.name,
                type: 'QB',
                radius: 25,
                yards: team.qb.yards,
                attempts: team.qb.attempts,
                tds: team.qb.tds,
                fx: width / 2,
                fy: height / 2
            };

            const receiverNodes = team.receivers.map((r, i) => ({
                id: r.name,
                name: r.name,
                type: r.pos,
                targets: r.targets,
                catches: r.catches,
                yards: r.yards,
                tds: r.tds,
                radius: 8 + (r.yards / 15) // Size by yards
            }));

            const nodes = [qbNode, ...receiverNodes];

            // Links from QB to each receiver
            const links = receiverNodes.map(r => ({
                source: 'qb',
                target: r.id,
                targets: r.targets,
                catches: r.catches,
                yards: r.yards,
                tds: r.tds
            }));

            // Find max targets for scaling
            const maxTargets = d3.max(links, d => d.targets);

            // Force simulation
            const simulation = d3.forceSimulation(nodes)
                .force('link', d3.forceLink(links).id(d => d.id).distance(90).strength(0.8))
                .force('charge', d3.forceManyBody().strength(-150))
                .force('center', d3.forceCenter(width / 2, height / 2))
                .force('collision', d3.forceCollide().radius(d => d.radius + 8));

            // Draw links
            const link = svg.append('g')
                .selectAll('line')
                .data(links)
                .join('line')
                .attr('stroke', d => d.tds > 0 ? '#22C55E' : '#666')
                .attr('stroke-width', d => 1 + (d.targets / maxTargets) * 6)
                .attr('opacity', 0.7);

            // Draw nodes
            const node = svg.append('g')
                .selectAll('circle')
                .data(nodes)
                .join('circle')
                .attr('r', d => d.radius)
                .attr('fill', d => d.type === 'QB' ? team.color : team.accent)
                .attr('stroke', d => d.type === 'QB' ? team.accent : team.color)
                .attr('stroke-width', d => d.type === 'QB' ? 3 : 2);

            // Labels
            const labels = svg.append('g')
                .selectAll('text')
                .data(nodes)
                .join('text')
                .attr('text-anchor', 'middle')
                .attr('dy', d => d.radius + 12)
                .attr('font-size', '9px')
                .attr('fill', '#aaa')
                .text(d => d.type === 'QB' ? d.name.split(' ')[1] : d.name.split(' ').pop());

            // Hover interactions
            node.on('mouseover', function(event, d) {
                let html = `<strong>${d.name}</strong> (${d.type})<br>`;
                if (d.type === 'QB') {
                    html += `<span class="stat-line">${d.attempts} att, ${d.yards} yds, ${d.tds} TD</span>`;
                } else {
                    html += `<span class="stat-line">${d.targets} tgt, ${d.catches} rec, ${d.yards} yds`;
                    if (d.tds > 0) html += `, ${d.tds} TD`;
                    html += `</span>`;
                }

                tooltip
                    .style('opacity', 1)
                    .style('left', (event.pageX + 10) + 'px')
                    .style('top', (event.pageY - 10) + 'px')
                    .html(html);

                // Highlight connections
                if (d.type !== 'QB') {
                    link.attr('opacity', l => l.target.id === d.id ? 1 : 0.15);
                    node.attr('opacity', n => n.id === d.id || n.type === 'QB' ? 1 : 0.3);
                }
            })
            .on('mouseout', function() {
                tooltip.style('opacity', 0);
                link.attr('opacity', 0.7);
                node.attr('opacity', 1);
            });

            // Update positions
            simulation.on('tick', () => {
                link
                    .attr('x1', d => d.source.x)
                    .attr('y1', d => d.source.y)
                    .attr('x2', d => d.target.x)
                    .attr('y2', d => d.target.y);

                node
                    .attr('cx', d => d.x = Math.max(d.radius + 5, Math.min(width - d.radius - 5, d.x)))
                    .attr('cy', d => d.y = Math.max(d.radius + 5, Math.min(height - d.radius - 5, d.y)));

                labels
                    .attr('x', d => d.x)
                    .attr('y', d => d.y);
            });
        });
    </script>
</body>
</html>
