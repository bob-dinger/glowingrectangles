<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exponential Sphere</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            background: #0a0a0f;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            min-height: 100vh;
            display: flex;
            overflow: hidden;
        }
        .back-link {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #666;
            text-decoration: none;
            font-size: 13px;
            z-index: 10;
        }
        .back-link:hover { color: #fff; }

        .left {
            width: 40%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            padding: 40px;
            border-right: 1px solid #222;
        }

        .right {
            width: 60%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .curve-title {
            font-size: 14px;
            color: #666;
            text-transform: uppercase;
            letter-spacing: 2px;
            margin-bottom: 30px;
        }

        .curve-container {
            position: relative;
            width: 100%;
            max-width: 350px;
        }

        #curveCanvas {
            width: 100%;
            border: 1px solid #222;
            border-radius: 8px;
        }

        .legend {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 30px;
            width: 100%;
            max-width: 350px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 13px;
        }

        .legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            flex-shrink: 0;
        }

        .legend-label { color: #888; }
        .legend-pct { margin-left: auto; color: #555; font-family: monospace; }

        .progress-bar {
            width: 100%;
            max-width: 350px;
            height: 4px;
            background: #222;
            border-radius: 2px;
            margin-top: 30px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: #FBBF24;
            width: 0%;
            transition: width 0.1s;
        }
    </style>
</head>
<body>
    <a href="index.html" class="back-link">← Back</a>

    <div class="left">
        <div class="curve-title">Exponential Growth</div>
        <div class="curve-container">
            <canvas id="curveCanvas" width="350" height="250"></canvas>
        </div>

        <div class="legend">
            <div class="legend-item">
                <div class="legend-dot" style="background: #666;"></div>
                <span class="legend-label">Quiet Start</span>
                <span class="legend-pct">0-50%</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: #FBBF24;"></div>
                <span class="legend-label">Tipping Point</span>
                <span class="legend-pct">50-75%</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: #F97316;"></div>
                <span class="legend-label">Explosion</span>
                <span class="legend-pct">75-90%</span>
            </div>
            <div class="legend-item">
                <div class="legend-dot" style="background: #EF4444;"></div>
                <span class="legend-label">Takeover</span>
                <span class="legend-pct">90-100%</span>
            </div>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>
    </div>

    <div class="right">
        <canvas id="sphereCanvas"></canvas>
    </div>

    <script>
        const curveCanvas = document.getElementById('curveCanvas');
        const curveCtx = curveCanvas.getContext('2d');
        const sphereCanvas = document.getElementById('sphereCanvas');
        const sphereCtx = sphereCanvas.getContext('2d');
        const progressFill = document.getElementById('progressFill');

        // Exponential segments
        const segments = [
            { threshold: 0.50, color: '#666', name: 'Quiet Start' },
            { threshold: 0.75, color: '#FBBF24', name: 'Tipping Point' },
            { threshold: 0.90, color: '#F97316', name: 'Explosion' },
            { threshold: 1.0, color: '#EF4444', name: 'Takeover' }
        ];

        function getColor(adoptionPoint) {
            for (let seg of segments) {
                if (adoptionPoint <= seg.threshold) return seg.color;
            }
            return segments[segments.length - 1].color;
        }

        // Sphere setup
        let sphereWidth, sphereHeight, centerX, centerY, radius;

        function resizeSphere() {
            const container = document.querySelector('.right');
            sphereWidth = container.clientWidth;
            sphereHeight = container.clientHeight;
            sphereCanvas.width = sphereWidth;
            sphereCanvas.height = sphereHeight;
            centerX = sphereWidth / 2;
            centerY = sphereHeight / 2;
            radius = Math.min(sphereWidth, sphereHeight) * 0.38;
        }
        resizeSphere();
        window.addEventListener('resize', resizeSphere);

        // Exponential function (normalized)
        function exponential(t, k = 5) {
            return (Math.exp(k * t) - 1) / (Math.exp(k) - 1);
        }

        // Generate sphere points
        const numPoints = 300;
        const points = [];

        for (let i = 0; i < numPoints; i++) {
            const phi = Math.acos(1 - 2 * (i + 0.5) / numPoints);
            const theta = Math.PI * (1 + Math.sqrt(5)) * i;
            const adoptionPoint = (i + 1) / numPoints;

            points.push({
                phi,
                theta,
                adoptionPoint,
                color: getColor(adoptionPoint),
                size: 3 + Math.random() * 2
            });
        }

        let time = 0;
        const cycleDuration = 8000;

        function drawCurve(progress) {
            const w = curveCanvas.width;
            const h = curveCanvas.height;
            const padding = 30;
            const graphW = w - padding * 2;
            const graphH = h - padding * 2;

            curveCtx.fillStyle = '#0a0a0f';
            curveCtx.fillRect(0, 0, w, h);

            curveCtx.lineWidth = 3;
            let prevX = padding;
            let prevY = h - padding;

            for (let t = 0; t <= 1; t += 0.005) {
                const x = padding + t * graphW;
                const y = h - padding - exponential(t) * graphH;
                const segIdx = segments.findIndex(s => exponential(t) <= s.threshold);

                curveCtx.beginPath();
                curveCtx.moveTo(prevX, prevY);
                curveCtx.lineTo(x, y);
                curveCtx.strokeStyle = segments[segIdx >= 0 ? segIdx : segments.length - 1].color;
                curveCtx.stroke();

                prevX = x;
                prevY = y;
            }

            const markerX = padding + progress * graphW;
            const markerY = h - padding - exponential(progress) * graphH;

            curveCtx.beginPath();
            curveCtx.moveTo(markerX, h - padding);
            curveCtx.lineTo(markerX, markerY);
            curveCtx.strokeStyle = 'rgba(255,255,255,0.2)';
            curveCtx.lineWidth = 1;
            curveCtx.stroke();

            curveCtx.beginPath();
            curveCtx.arc(markerX, markerY, 6, 0, Math.PI * 2);
            curveCtx.fillStyle = '#fff';
            curveCtx.fill();

            curveCtx.strokeStyle = '#333';
            curveCtx.lineWidth = 1;
            curveCtx.beginPath();
            curveCtx.moveTo(padding, padding);
            curveCtx.lineTo(padding, h - padding);
            curveCtx.lineTo(w - padding, h - padding);
            curveCtx.stroke();

            curveCtx.fillStyle = '#555';
            curveCtx.font = '10px -apple-system, sans-serif';
            curveCtx.fillText('Time →', w - padding - 40, h - padding + 20);
        }

        function drawSphere(progress) {
            sphereCtx.fillStyle = '#0a0a0f';
            sphereCtx.fillRect(0, 0, sphereWidth, sphereHeight);

            const adoptionLevel = exponential(progress);
            const rotationY = time * 0.2;
            const rotationX = 0.3;

            const projected = points.map(p => {
                let x = Math.sin(p.phi) * Math.cos(p.theta + rotationY);
                let y = Math.cos(p.phi);
                let z = Math.sin(p.phi) * Math.sin(p.theta + rotationY);

                const y2 = y * Math.cos(rotationX) - z * Math.sin(rotationX);
                const z2 = y * Math.sin(rotationX) + z * Math.cos(rotationX);
                y = y2;
                z = z2;

                const activated = adoptionLevel >= p.adoptionPoint;

                return { x, y, z, activated, color: p.color, size: p.size };
            });

            projected.sort((a, b) => a.z - b.z);

            sphereCtx.beginPath();
            sphereCtx.arc(centerX, centerY, radius, 0, Math.PI * 2);
            sphereCtx.strokeStyle = 'rgba(255,255,255,0.05)';
            sphereCtx.lineWidth = 1;
            sphereCtx.stroke();

            projected.forEach(p => {
                const scale = (p.z + 1.5) / 2.5;
                const screenX = centerX + p.x * radius;
                const screenY = centerY + p.y * radius;
                const size = p.size * scale;

                sphereCtx.beginPath();
                sphereCtx.arc(screenX, screenY, size, 0, Math.PI * 2);

                if (p.activated) {
                    sphereCtx.fillStyle = p.color;
                    if (p.z > 0.3) {
                        sphereCtx.shadowColor = p.color;
                        sphereCtx.shadowBlur = 12;
                    }
                } else {
                    sphereCtx.fillStyle = `rgba(40, 40, 40, ${0.2 + scale * 0.2})`;
                    sphereCtx.shadowBlur = 0;
                }

                sphereCtx.fill();
                sphereCtx.shadowBlur = 0;
            });
        }

        function animate() {
            const elapsed = (performance.now() % cycleDuration) / cycleDuration;

            drawCurve(elapsed);
            drawSphere(elapsed);
            progressFill.style.width = (elapsed * 100) + '%';

            time += 0.016;
            requestAnimationFrame(animate);
        }

        animate();
    </script>
</body>
</html>
